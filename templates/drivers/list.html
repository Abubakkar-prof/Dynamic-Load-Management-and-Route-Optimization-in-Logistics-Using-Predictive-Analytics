{% extends "base.html" %}

{% block title %}Drivers - Logistics AI{% endblock %}

{% block content %}
<div class="section-header">
    <div>
        <div class="x-small text-body opacity-50 fw-bold text-uppercase mb-1" style="letter-spacing: 1px;">Human
            Resources</div>
        <h2 class="fw-bold text-heading mb-1" style="letter-spacing: -1px;">Personnel Registry</h2>
        <p class="text-body mb-0 small">Operational tracking of certified fleet personnel and mission performance.</p>
    </div>
</div>

<div class="card p-0 overflow-hidden">
    <div
        class="px-4 py-3 border-bottom border-white border-opacity-5 bg-dark bg-opacity-25 d-flex justify-content-between align-items-center">
        <h6 class="fw-bold mb-0 text-heading small"><i class="fas fa-users-gear me-2 text-primary"></i>Active Operators
        </h6>
        <div class="badge bg-primary bg-opacity-10 text-primary border-0 px-3 py-1 rounded-pill x-small fw-bold">{{
            drivers|length }} REGISTERED</div>
    </div>
    <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
            <thead class="bg-dark bg-opacity-25">
                <tr class="x-small text-uppercase fw-bold text-body opacity-50" style="letter-spacing: 1px;">
                    <th class="ps-4 py-3">Operator Identifier</th>
                    <th class="py-3">Credential/License</th>
                    <th class="py-3 text-center">Hardware Assignment</th>
                    <th class="py-3 text-center">Duty State</th>
                    <th class="py-3 text-center">Perf. Rating</th>
                    <th class="py-3 text-center">Missions</th>
                    <th class="pe-4 py-3 text-end">Interface</th>
                </tr>
            </thead>
            <tbody>
                {% for driver in drivers %}
                <tr class="border-white border-opacity-5">
                    <td class="ps-4 py-3">
                        <div class="d-flex align-items-center">
                            <div class="bg-secondary rounded-circle d-flex align-items-center justify-content-center me-3"
                                style="width: 32px; height: 32px; border: 1px solid var(--border-default);">
                                <i class="fas fa-user-circle opacity-50"></i>
                            </div>
                            <div>
                                <div class="fw-bold text-heading small mb-0">{{ driver.user.full_name if driver.user
                                    else 'DE-IDENTIFIED' }}</div>
                                <div class="x-small text-body opacity-50">{{ driver.user.email if driver.user else 'No
                                    Email Registry' }}</div>
                            </div>
                        </div>
                    </td>
                    <td class="py-3">
                        <code class="x-small text-primary fw-bold">{{ driver.license_number }}</code>
                    </td>
                    <td class="py-3 text-center">
                        {% if driver.vehicle %}
                        <span class="badge bg-info bg-opacity-10 text-info border-0 px-2 py-1 x-small fw-bold">{{
                            driver.vehicle.vehicle_id }}</span>
                        {% else %}
                        <span class="opacity-25 x-small fw-bold">UNASSIGNED</span>
                        {% endif %}
                    </td>
                    <td class="py-3 text-center">
                        {% set status_val = driver.status.value if driver.status.value is defined else
                        driver.status|string %}
                        {% if status_val == 'Available' %}
                        <span
                            class="badge bg-success bg-opacity-10 text-success border-0 px-2 py-1 x-small fw-bold">AVAILABLE</span>
                        {% elif status_val == 'On Duty' %}
                        <span class="badge bg-primary bg-opacity-10 text-primary border-0 px-2 py-1 x-small fw-bold">ON
                            DUTY</span>
                        {% else %}
                        <span
                            class="badge bg-secondary bg-opacity-10 text-secondary border-0 px-2 py-1 x-small fw-bold">{{
                            status_val|upper }}</span>
                        {% endif %}
                    </td>
                    <td class="py-3 text-center">
                        <div class="d-flex align-items-center justify-content-center gap-1">
                            <i class="fas fa-star text-warning x-small"></i>
                            <span class="fw-bold text-heading small">{{ driver.rating }}</span>
                        </div>
                    </td>
                    <td class="py-3 text-center">
                        <span class="text-body small fw-bold">{{ driver.total_deliveries }}</span>
                    </td>
                    <td class="pe-4 py-3 text-end">
                        <a href="{{ url_for('drivers.view_driver', driver_id=driver.id) }}"
                            class="btn btn-secondary btn-sm rounded-3 px-3 py-2 border-white border-opacity-10">
                            <i class="fas fa-id-card me-2 text-primary"></i>Profile
                        </a>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" class="text-center py-5">
                        <div class="opacity-25 mb-3">
                            <i class="fas fa-user-slash fa-3x"></i>
                        </div>
                        <h6 class="text-heading fw-bold">No personnel records found</h6>
                        <p class="text-body x-small mb-0">The personnel data lake is currently empty.</p>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}